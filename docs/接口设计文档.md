# 威高机器人控制系统接口设计文档

## 文档版本信息

| 版本号 | 日期 | 作者 | 变更说明 |
|--------|------|------|----------|
| v1.0.0 | 2026-01-18 | System | 初始版本 |

## 一、概述

本文档定义了威高机器人控制系统的完整接口体系，旨在支持双人协同开发模式：
- **开发人员A（架构与硬件基建）**：负责架构层接口的实现，包括硬件控制、通信协议、数据处理等核心功能
- **开发人员B（业务应用与交互）**：负责应用层接口的实现，包括标准配送、循环配送、回收配送等具体业务功能

### 1.1 设计原则

1. **高内聚低耦合**：明确划分架构层与应用层边界，各层职责清晰
2. **易用性**：提供简洁易用的高层API，隐藏底层复杂性
3. **一致性**：统一接口命名规范、参数格式和返回值结构
4. **可扩展性**：预留扩展点，支持功能增强和版本升级
5. **完善的错误处理**：提供统一的错误码和错误处理机制

### 1.2 架构分层

```
┌─────────────────────────────────────────┐
│         UI层 (Presentation Layer)        │
│  - Activity/Fragment                    │
│  - ViewModel                            │
│  - LiveData/StateFlow                   │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│      应用层接口 (Application Layer)      │
│  - IDeliveryService (配送服务)          │
│  - IPointService (点位服务)              │
│  - IDoorService (舱门服务)               │
│  - IRemoteService (远程服务)             │
│  - IAudioService (音频服务)              │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│      架构层接口 (Architecture Layer)      │
│  - IRobotDevice (设备抽象)               │
│  - IMotorController (电机控制)           │
│  - ICommunication (通信管理)             │
│  - IDataProcessor (数据处理)             │
│  - IStateManager (状态管理)              │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│      SDK层 (Peanut SDK Wrapper)          │
│  - PeanutSDK                             │
└─────────────────────────────────────────┘
```

## 二、架构层接口定义（开发人员A）

### 2.1 设备管理接口 - IRobotDevice

#### 2.1.1 接口说明

提供机器人硬件设备的管理功能，包括设备信息获取、配置管理、设备控制等。

#### 2.1.2 方法定义

##### getDeviceList

**方法签名**：
```java
void getDeviceList(IResultCallback<DeviceInfo> callback)
```

**功能说明**：获取机器人所有设备列表

**参数说明**：
- `callback`: 结果回调，返回设备信息列表

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.getDeviceList(new IResultCallback<DeviceInfo>() {
    @Override
    public void onSuccess(DeviceInfo result) {
        Log.d(TAG, "Device list: " + result.getName());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get device list: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_NETWORK`: 网络连接失败
- `ErrorCode.ERROR_DEVICE`: 设备通信失败
- `ErrorCode.ERROR_TIMEOUT`: 请求超时

**前置条件**：
- SDK已初始化
- 机器人已开机并连接

---

##### getBoardInfo

**方法签名**：
```java
void getBoardInfo(String board, IResultCallback<DeviceInfo> callback)
```

**功能说明**：获取指定主板的详细信息

**参数说明**：
- `board`: 主板名称（如"robot-arm", "robot-stm32"）
- `callback`: 结果回调，返回主板信息

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.getBoardInfo("robot-arm", new IResultCallback<DeviceInfo>() {
    @Override
    public void onSuccess(DeviceInfo result) {
        Log.d(TAG, "Board version: " + result.getVersion().getSw().getNumber());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get board info: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 设备不存在或通信失败

**前置条件**：
- SDK已初始化
- 指定主板存在

---

##### getConfig

**方法签名**：
```java
void getConfig(IResultCallback<String> callback)
```

**功能说明**：获取设备配置信息

**参数说明**：
- `callback`: 结果回调，返回配置JSON字符串

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.getConfig(new IResultCallback<String>() {
    @Override
    public void onSuccess(String result) {
        Log.d(TAG, "Config: " + result);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get config: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取配置失败

**前置条件**：
- SDK已初始化

---

##### updateConfig

**方法签名**：
```java
void updateConfig(String params, IResultCallback<String> callback)
```

**功能说明**：更新设备配置

**参数说明**：
- `params`: 配置参数JSON字符串
- `callback`: 结果回调，返回更新后的配置

**返回值**：无（通过回调返回）

**调用示例**：
```java
Map<String, String> params = new HashMap<>();
params.put("schedulePathWaitTime", "20");
String jsonString = new JSONObject(params).toString();

robotDevice.updateConfig(jsonString, new IResultCallback<String>() {
    @Override
    public void onSuccess(String result) {
        Log.d(TAG, "Config updated: " + result);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to update config: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 参数格式错误
- `ErrorCode.ERROR_DEVICE`: 配置更新失败

**前置条件**：
- SDK已初始化
- 参数格式正确

**注意事项**：
- 配置下发后ROS会存文件保存
- ROS升级或替换后配置会丢失，需要重新下发

---

##### reboot

**方法签名**：
```java
void reboot(IResultCallback<Void> callback)
```

**功能说明**：重启机器人设备

**参数说明**：
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.reboot(new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Reboot command sent");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to reboot: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 重启命令发送失败

**前置条件**：
- SDK已初始化
- 机器人处于可重启状态

**注意事项**：
- 重启后需要重新初始化SDK

---

##### getScramButtonStatus

**方法签名**：
```java
void getScramButtonStatus(IResultCallback<Boolean> callback)
```

**功能说明**：获取急停按钮状态

**参数说明**：
- `callback`: 结果回调，返回急停按钮是否按下

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.getScramButtonStatus(new IResultCallback<Boolean>() {
    @Override
    public void onSuccess(Boolean result) {
        if (result) {
            Log.w(TAG, "Scram button is pressed!");
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get scram status: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取状态失败

**前置条件**：
- SDK已初始化

---

##### openFan / closeFan

**方法签名**：
```java
void openFan(int fanId, IResultCallback<Void> callback)
void closeFan(int fanId, IResultCallback<Void> callback)
```

**功能说明**：控制W3机器舱内风扇

**参数说明**：
- `fanId`: 风扇ID（0, 1, 2, 3）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
robotDevice.openFan(2, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Fan 2 opened");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to open fan: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 风扇控制失败
- `ErrorCode.ERROR_VALIDATION`: 风扇ID无效

**前置条件**：
- SDK已初始化
- 风扇ID有效（0-3）

---

### 2.2 电机控制接口 - IMotorController

#### 2.2.1 接口说明

提供电机状态查询、健康检查、速度控制等功能。

#### 2.2.2 方法定义

##### getStatus

**方法签名**：
```java
void getStatus(IResultCallback<MotorInfo> callback)
```

**功能说明**：获取电机状态信息

**参数说明**：
- `callback`: 结果回调，返回电机信息

**返回值**：无（通过回调返回）

**调用示例**：
```java
motorController.getStatus(new IResultCallback<MotorInfo>() {
    @Override
    public void onSuccess(MotorInfo result) {
        Log.d(TAG, "Motor enabled: " + result.isEnabled());
        Log.d(TAG, "Motor speed: " + result.getSpeed());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get motor status: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取状态失败

**前置条件**：
- SDK已初始化

---

##### getHealth

**方法签名**：
```java
void getHealth(IResultCallback<MotorInfo> callback)
```

**功能说明**：获取电机健康状态

**参数说明**：
- `callback`: 结果回调，返回电机健康信息

**返回值**：无（通过回调返回）

**调用示例**：
```java
motorController.getHealth(new IResultCallback<MotorInfo>() {
    @Override
    public void onSuccess(MotorInfo result) {
        Log.d(TAG, "Motor health code: " + result.getCode());
        Log.d(TAG, "Motor health desc: " + result.getDesc());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get motor health: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取健康状态失败

**前置条件**：
- SDK已初始化

---

##### enableMotor

**方法签名**：
```java
void enableMotor(boolean enabled, IResultCallback<Void> callback)
```

**功能说明**：控制电机启停

**参数说明**：
- `enabled`: true-启用电机，false-禁用电机
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
motorController.enableMotor(true, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Motor enabled");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to enable motor: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 电机控制失败
- `ErrorCode.ERROR_SCRAM_PRESSED`: 急停按钮按下，无法操作

**前置条件**：
- SDK已初始化
- 急停按钮未按下

---

##### setSpeed

**方法签名**：
```java
void setSpeed(int speed, IResultCallback<Void> callback)
```

**功能说明**：设置电机速度

**参数说明**：
- `speed`: 速度值（cm/s）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
motorController.setSpeed(50, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Motor speed set to 50 cm/s");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set speed: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 速度值超出范围
- `ErrorCode.ERROR_DEVICE`: 设置速度失败

**前置条件**：
- SDK已初始化
- 速度值在有效范围内

---

##### stopMotor

**方法签名**：
```java
void stopMotor(IResultCallback<Void> callback)
```

**功能说明**：停止电机

**参数说明**：
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
motorController.stopMotor(new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Motor stopped");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to stop motor: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 停止电机失败

**前置条件**：
- SDK已初始化

---

### 2.3 通信管理接口 - ICommunication

#### 2.3.1 接口说明

管理与机器人的通信连接，包括连接初始化、请求发送、断开连接等。

#### 2.3.2 方法定义

##### initialize

**方法签名**：
```java
void initialize(IResultCallback<Boolean> callback)
```

**功能说明**：初始化通信连接

**参数说明**：
- `callback`: 结果回调，返回初始化是否成功

**返回值**：无（通过回调返回）

**调用示例**：
```java
communication.initialize(new IResultCallback<Boolean>() {
    @Override
    public void onSuccess(Boolean result) {
        if (result) {
            Log.d(TAG, "Communication initialized");
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to initialize: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_NETWORK`: 网络连接失败
- `ErrorCode.ERROR_TIMEOUT`: 连接超时

**前置条件**：
- SDK已初始化

---

##### sendRequest

**方法签名**：
```java
void sendRequest(String endpoint, String data, IResultCallback<String> callback)
```

**功能说明**：发送请求到指定端点

**参数说明**：
- `endpoint`: 请求端点
- `data`: 请求数据（JSON字符串）
- `callback`: 结果回调，返回响应数据

**返回值**：无（通过回调返回）

**调用示例**：
```java
String jsonData = "{\"action\":\"start\",\"points\":[\"point1\",\"point2\"]}";
communication.sendRequest("/delivery/start", jsonData, new IResultCallback<String>() {
    @Override
    public void onSuccess(String result) {
        Log.d(TAG, "Request successful: " + result);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Request failed: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_NETWORK`: 网络请求失败
- `ErrorCode.ERROR_TIMEOUT`: 请求超时
- `ErrorCode.ERROR_VALIDATION`: 请求数据格式错误

**前置条件**：
- 通信已初始化
- 请求数据格式正确

---

##### disconnect

**方法签名**：
```java
void disconnect(IResultCallback<Void> callback)
```

**功能说明**：断开通信连接

**参数说明**：
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
communication.disconnect(new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Disconnected");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to disconnect: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_NETWORK`: 断开连接失败

**前置条件**：
- 通信已连接

---

##### isConnected

**方法签名**：
```java
boolean isConnected()
```

**功能说明**：检查通信连接状态

**参数说明**：无

**返回值**：true-已连接，false-未连接

**调用示例**：
```java
if (communication.isConnected()) {
    Log.d(TAG, "Connected");
} else {
    Log.d(TAG, "Not connected");
}
```

---

##### setConnectionTimeout / getConnectionTimeout

**方法签名**：
```java
void setConnectionTimeout(int timeoutMs)
int getConnectionTimeout()
```

**功能说明**：设置/获取连接超时时间

**参数说明**：
- `timeoutMs`: 超时时间（毫秒）

**返回值**：
- `setConnectionTimeout`: 无
- `getConnectionTimeout`: 当前超时时间（毫秒）

**调用示例**：
```java
communication.setConnectionTimeout(10000);
int timeout = communication.getConnectionTimeout();
Log.d(TAG, "Connection timeout: " + timeout + "ms");
```

---

### 2.4 数据处理接口 - IDataProcessor

#### 2.4.1 接口说明

提供数据解析、验证、转换等功能。

#### 2.4.2 方法定义

##### parseResponse

**方法签名**：
```java
<T> T parseResponse(String jsonResponse, Class<T> clazz)
```

**功能说明**：解析JSON响应数据

**参数说明**：
- `jsonResponse`: JSON字符串
- `clazz`: 目标类型

**返回值**：解析后的对象

**调用示例**：
```java
String jsonData = "{\"id\":1,\"name\":\"Point1\",\"floor\":1,\"x\":10.5,\"y\":20.3}";
PointInfo point = dataProcessor.parseResponse(jsonData, PointInfo.class);
Log.d(TAG, "Point name: " + point.getName());
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: JSON格式错误

**前置条件**：
- JSON格式正确
- 目标类型与JSON结构匹配

---

##### serializeRequest

**方法签名**：
```java
String serializeRequest(Object request)
```

**功能说明**：序列化请求数据为JSON字符串

**参数说明**：
- `request`: 请求对象

**返回值**：JSON字符串

**调用示例**：
```java
PointInfo point = new PointInfo();
point.setName("Point1");
point.setFloor(1);
String jsonData = dataProcessor.serializeRequest(point);
Log.d(TAG, "Serialized: " + jsonData);
```

---

##### validateData

**方法签名**：
```java
boolean validateData(String data)
```

**功能说明**：验证数据格式

**参数说明**：
- `data`: 待验证的数据

**返回值**：true-数据有效，false-数据无效

**调用示例**：
```java
String jsonData = "{\"id\":1,\"name\":\"Point1\"}";
boolean isValid = dataProcessor.validateData(jsonData);
if (isValid) {
    Log.d(TAG, "Data is valid");
} else {
    Log.e(TAG, "Data is invalid");
}
```

---

##### parseDeviceInfo / parseMotorInfo / parsePointInfo

**方法签名**：
```java
DeviceInfo parseDeviceInfo(String jsonData)
MotorInfo parseMotorInfo(String jsonData)
PointInfo parsePointInfo(String jsonData)
```

**功能说明**：解析特定类型的数据

**参数说明**：
- `jsonData`: JSON字符串

**返回值**：解析后的对象

**调用示例**：
```java
String jsonData = "{\"id\":1,\"name\":\"robot-arm\"}";
DeviceInfo deviceInfo = dataProcessor.parseDeviceInfo(jsonData);
Log.d(TAG, "Device name: " + deviceInfo.getName());
```

---

### 2.5 状态管理接口 - IStateManager

#### 2.5.1 接口说明

管理机器人状态，包括状态获取、更新、监听等。

#### 2.5.2 方法定义

##### getCurrentState

**方法签名**：
```java
RobotState getCurrentState()
```

**功能说明**：获取当前机器人状态

**参数说明**：无

**返回值**：当前机器人状态

**调用示例**：
```java
RobotState state = stateManager.getCurrentState();
Log.d(TAG, "Robot status: " + state.getStatus());
Log.d(TAG, "Battery level: " + state.getBatteryLevel());
```

---

##### updateState

**方法签名**：
```java
void updateState(RobotState state)
```

**功能说明**：更新机器人状态

**参数说明**：
- `state`: 新的状态

**返回值**：无

**调用示例**：
```java
RobotState newState = new RobotState();
newState.setStatus(1);
newState.setBatteryLevel(80);
stateManager.updateState(newState);
```

---

##### registerStateListener / unregisterStateListener

**方法签名**：
```java
void registerStateListener(IStateCallback listener)
void unregisterStateListener(IStateCallback listener)
```

**功能说明**：注册/注销状态监听器

**参数说明**：
- `listener`: 状态回调监听器

**返回值**：无

**调用示例**：
```java
IStateCallback listener = new IStateCallback() {
    @Override
    public void onStateChanged(RobotState newState) {
        Log.d(TAG, "State changed: " + newState.getStatus());
    }

    @Override
    public void onLocationChanged(double x, double y) {
        Log.d(TAG, "Location changed: " + x + ", " + y);
    }

    @Override
    public void onBatteryLevelChanged(int level) {
        Log.d(TAG, "Battery level: " + level);
    }

    @Override
    public void onScramButtonPressed(boolean pressed) {
        Log.w(TAG, "Scram button: " + pressed);
    }
};

stateManager.registerStateListener(listener);

stateManager.unregisterStateListener(listener);
```

---

##### clearStateListeners

**方法签名**：
```java
void clearStateListeners()
```

**功能说明**：清除所有状态监听器

**参数说明**：无

**返回值**：无

**调用示例**：
```java
stateManager.clearStateListeners();
```

---

##### saveState / loadState

**方法签名**：
```java
void saveState()
void loadState()
```

**功能说明**：保存/加载状态到持久化存储

**参数说明**：无

**返回值**：无

**调用示例**：
```java
stateManager.saveState();
stateManager.loadState();
```

---

## 三、应用层接口定义（开发人员B）

### 3.1 配送服务接口 - IDeliveryService

#### 3.1.1 接口说明

提供配送任务的管理功能，包括标准配送、循环配送、回收配送、慢速配送等。

#### 3.1.2 方法定义

##### startStandardDelivery

**方法签名**：
```java
void startStandardDelivery(DeliveryTask task, IResultCallback<String> callback)
```

**功能说明**：启动标准配送任务

**参数说明**：
- `task`: 配送任务对象
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
DeliveryTask task = new DeliveryTask();
task.setType(DeliveryTask.DeliveryType.STANDARD);
task.setPoints(Arrays.asList(point1, point2));

deliveryService.startStandardDelivery(task, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Standard delivery started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to start delivery: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 任务参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 任务启动失败
- `ErrorCode.ERROR_SCRAM_PRESSED`: 急停按钮按下

**前置条件**：
- SDK已初始化
- 点位有效
- 机器人处于空闲状态

**注意事项**：
- 执行从"待机点"出发，将物品运送至指定"目的地"或"点位"的单次运输任务

---

##### startLoopDelivery

**方法签名**：
```java
void startLoopDelivery(DeliveryTask task, IResultCallback<String> callback)
```

**功能说明**：启动循环配送任务

**参数说明**：
- `task`: 配送任务对象
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
DeliveryTask task = new DeliveryTask();
task.setType(DeliveryTask.DeliveryType.LOOP);
task.setPoints(Arrays.asList(point1, point2, point3));
task.getConfig().setLoopCount(5);

deliveryService.startLoopDelivery(task, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Loop delivery started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to start loop delivery: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 任务参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 任务启动失败

**前置条件**：
- SDK已初始化
- 点位有效
- 机器人处于空闲状态

**注意事项**：
- 机器人在预设的"循环点位"之间按照既定路线进行往复移动，执行持续的转运任务

---

##### startRecoveryDelivery

**方法签名**：
```java
void startRecoveryDelivery(DeliveryTask task, IResultCallback<String> callback)
```

**功能说明**：启动物品回收配送任务

**参数说明**：
- `task`: 配送任务对象
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
DeliveryTask task = new DeliveryTask();
task.setType(DeliveryTask.DeliveryType.RECOVERY);
task.setPoints(Arrays.asList(point1, point2, recoveryPoint));

deliveryService.startRecoveryDelivery(task, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Recovery delivery started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to start recovery: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 任务参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 任务启动失败

**前置条件**：
- SDK已初始化
- 点位有效
- 机器人处于空闲状态

**注意事项**：
- 执行从各个点位收集物品并运回"回收"点的功能

---

##### startSlowDelivery

**方法签名**：
```java
void startSlowDelivery(DeliveryTask task, IResultCallback<String> callback)
```

**功能说明**：启动慢速配送任务

**参数说明**：
- `task`: 配送任务对象
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
DeliveryTask task = new DeliveryTask();
task.setType(DeliveryTask.DeliveryType.SLOW);
task.setPoints(Arrays.asList(point1));
task.getConfig().setDeliverySpeed(30);

deliveryService.startSlowDelivery(task, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Slow delivery started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to start slow delivery: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 任务参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 任务启动失败

**前置条件**：
- SDK已初始化
- 点位有效
- 机器人处于空闲状态

**注意事项**：
- 针对精密或易碎物品（如内镜），系统提供特定的运动控制算法，使机器人在移动过程中保持低速和平稳，减少震动

---

##### pauseDelivery / resumeDelivery

**方法签名**：
```java
void pauseDelivery(String taskId, IResultCallback<Void> callback)
void resumeDelivery(String taskId, IResultCallback<Void> callback)
```

**功能说明**：暂停/恢复配送任务

**参数说明**：
- `taskId`: 任务ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
deliveryService.pauseDelivery(taskId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Delivery paused");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to pause: " + error.getMessage());
    }
});

deliveryService.resumeDelivery(taskId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Delivery resumed");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to resume: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_TASK_NOT_FOUND`: 任务不存在
- `ErrorCode.ERROR_TASK_FAILED`: 操作失败

**前置条件**：
- 任务存在
- 任务处于可暂停/恢复状态

---

##### cancelDelivery

**方法签名**：
```java
void cancelDelivery(String taskId, IResultCallback<Void> callback)
```

**功能说明**：取消配送任务

**参数说明**：
- `taskId`: 任务ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
deliveryService.cancelDelivery(taskId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Delivery cancelled");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to cancel: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_TASK_NOT_FOUND`: 任务不存在
- `ErrorCode.ERROR_TASK_FAILED`: 取消失败

**前置条件**：
- 任务存在

---

##### getDeliveryStatus

**方法签名**：
```java
void getDeliveryStatus(String taskId, IResultCallback<DeliveryTask> callback)
```

**功能说明**：获取配送任务状态

**参数说明**：
- `taskId`: 任务ID
- `callback`: 结果回调，返回任务信息

**返回值**：无（通过回调返回）

**调用示例**：
```java
deliveryService.getDeliveryStatus(taskId, new IResultCallback<DeliveryTask>() {
    @Override
    public void onSuccess(DeliveryTask task) {
        Log.d(TAG, "Task status: " + task.getStatus());
        Log.d(TAG, "Progress: " + task.getProgress() + "%");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get status: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_TASK_NOT_FOUND`: 任务不存在

**前置条件**：
- 任务存在

---

##### updateDeliveryConfig / getDeliveryConfig

**方法签名**：
```java
void updateDeliveryConfig(DeliveryConfig config, IResultCallback<Void> callback)
void getDeliveryConfig(IResultCallback<DeliveryConfig> callback)
```

**功能说明**：更新/获取配送配置

**参数说明**：
- `config`: 配送配置对象
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
DeliveryConfig config = new DeliveryConfig();
config.setDeliverySpeed(50);
config.setReturnSpeed(60);
config.setStayDuration(30);

deliveryService.updateDeliveryConfig(config, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Config updated");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to update config: " + error.getMessage());
    }
});

deliveryService.getDeliveryConfig(new IResultCallback<DeliveryConfig>() {
    @Override
    public void onSuccess(DeliveryConfig config) {
        Log.d(TAG, "Delivery speed: " + config.getDeliverySpeed());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get config: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 配置参数无效
- `ErrorCode.ERROR_DEVICE`: 配置更新失败

**前置条件**：
- SDK已初始化

---

### 3.2 点位服务接口 - IPointService

#### 3.2.1 接口说明

提供点位管理功能，包括点位查询、添加、删除、更新等。

#### 3.2.2 方法定义

##### getAllPoints

**方法签名**：
```java
void getAllPoints(IResultCallback<List<PointInfo>> callback)
```

**功能说明**：获取所有点位

**参数说明**：
- `callback`: 结果回调，返回点位列表

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.getAllPoints(new IResultCallback<List<PointInfo>>() {
    @Override
    public void onSuccess(List<PointInfo> points) {
        for (PointInfo point : points) {
            Log.d(TAG, "Point: " + point.getName());
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get points: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取点位失败

**前置条件**：
- SDK已初始化

---

##### getRecentPoints

**方法签名**：
```java
void getRecentPoints(IResultCallback<List<PointInfo>> callback)
```

**功能说明**：获取最近使用的点位

**参数说明**：
- `callback`: 结果回调，返回最近使用的点位列表

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.getRecentPoints(new IResultCallback<List<PointInfo>>() {
    @Override
    public void onSuccess(List<PointInfo> points) {
        for (PointInfo point : points) {
            Log.d(TAG, "Recent point: " + point.getName());
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get recent points: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取点位失败

**前置条件**：
- SDK已初始化
- 最近使用点位功能已开启

**注意事项**：
- 开启后，若有最近使用点位则会展示在点位区域

---

##### getPointsByFloor

**方法签名**：
```java
void getPointsByFloor(int floor, IResultCallback<List<PointInfo>> callback)
```

**功能说明**：获取指定楼层的点位

**参数说明**：
- `floor`: 楼层号
- `callback`: 结果回调，返回点位列表

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.getPointsByFloor(1, new IResultCallback<List<PointInfo>>() {
    @Override
    public void onSuccess(List<PointInfo> points) {
        for (PointInfo point : points) {
            Log.d(TAG, "Floor 1 point: " + point.getName());
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get floor points: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 楼层号无效
- `ErrorCode.ERROR_DEVICE`: 获取点位失败

**前置条件**：
- SDK已初始化
- 楼层号有效

---

##### addPoint

**方法签名**：
```java
void addPoint(PointInfo point, IResultCallback<String> callback)
```

**功能说明**：添加新点位

**参数说明**：
- `point`: 点位信息
- `callback`: 结果回调，返回点位ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
PointInfo point = new PointInfo();
point.setName("New Point");
point.setFloor(1);
point.setX(10.5);
point.setY(20.3);
point.setType("DESTINATION");

pointService.addPoint(point, new IResultCallback<String>() {
    @Override
    public void onSuccess(String pointId) {
        Log.d(TAG, "Point added: " + pointId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to add point: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 点位参数无效
- `ErrorCode.ERROR_DEVICE`: 添加点位失败

**前置条件**：
- SDK已初始化
- 点位参数有效

---

##### deletePoint

**方法签名**：
```java
void deletePoint(String pointId, IResultCallback<Void> callback)
```

**功能说明**：删除点位

**参数说明**：
- `pointId`: 点位ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.deletePoint(pointId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Point deleted");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to delete point: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_POINT_NOT_FOUND`: 点位不存在
- `ErrorCode.ERROR_DEVICE`: 删除点位失败

**前置条件**：
- SDK已初始化
- 点位存在

---

##### updatePoint

**方法签名**：
```java
void updatePoint(PointInfo point, IResultCallback<Void> callback)
```

**功能说明**：更新点位信息

**参数说明**：
- `point`: 点位信息
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
PointInfo point = new PointInfo();
point.setId(pointId);
point.setName("Updated Point");
point.setFloor(2);

pointService.updatePoint(point, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Point updated");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to update point: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_POINT_NOT_FOUND`: 点位不存在
- `ErrorCode.ERROR_VALIDATION`: 点位参数无效
- `ErrorCode.ERROR_DEVICE`: 更新点位失败

**前置条件**：
- SDK已初始化
- 点位存在

---

##### setReturnPoint / getReturnPoint

**方法签名**：
```java
void setReturnPoint(String pointId, IResultCallback<Void> callback)
void getReturnPoint(IResultCallback<PointInfo> callback)
```

**功能说明**：设置/获取返回点

**参数说明**：
- `pointId`: 点位ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.setReturnPoint(pointId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Return point set");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set return point: " + error.getMessage());
    }
});

pointService.getReturnPoint(new IResultCallback<PointInfo>() {
    @Override
    public void onSuccess(PointInfo point) {
        Log.d(TAG, "Return point: " + point.getName());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get return point: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_POINT_NOT_FOUND`: 点位不存在
- `ErrorCode.ERROR_DEVICE`: 操作失败

**前置条件**：
- SDK已初始化
- 点位存在

**注意事项**：
- 任务完成后，机器人具备自动前往"返回点"或"待机点"等待下一指令的能力

---

##### setStandbyPoint / getStandbyPoint

**方法签名**：
```java
void setStandbyPoint(String pointId, IResultCallback<Void> callback)
void getStandbyPoint(IResultCallback<PointInfo> callback)
```

**功能说明**：设置/获取待机点

**参数说明**：
- `pointId`: 点位ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
pointService.setStandbyPoint(pointId, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Standby point set");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set standby point: " + error.getMessage());
    }
});

pointService.getStandbyPoint(new IResultCallback<PointInfo>() {
    @Override
    public void onSuccess(PointInfo point) {
        Log.d(TAG, "Standby point: " + point.getName());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get standby point: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_POINT_NOT_FOUND`: 点位不存在
- `ErrorCode.ERROR_DEVICE`: 操作失败

**前置条件**：
- SDK已初始化
- 点位存在

---

### 3.3 舱门服务接口 - IDoorService

#### 3.3.1 接口说明

提供舱门控制功能，包括开门、关门、密码验证等。

#### 3.3.2 方法定义

##### openDoor / closeDoor

**方法签名**：
```java
void openDoor(int doorId, IResultCallback<Void> callback)
void closeDoor(int doorId, IResultCallback<Void> callback)
```

**功能说明**：打开/关闭指定舱门

**参数说明**：
- `doorId`: 舱门ID
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
doorService.openDoor(1, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Door 1 opened");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to open door: " + error.getMessage());
    }
});

doorService.closeDoor(1, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Door 1 closed");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to close door: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DOOR_LOCKED`: 舱门锁定
- `ErrorCode.ERROR_PASSWORD_INCORRECT`: 密码错误
- `ErrorCode.ERROR_DEVICE`: 舱门控制失败

**前置条件**：
- SDK已初始化
- 舱门ID有效
- 密码验证通过（如果需要）

**注意事项**：
- 机器人到达目的地后，选择要开启的取物舱门，输入预设的固定密码才能通过验证，允许开启舱门进行物品取用
- 在配送任务执行过程中，若需人为强行中断任务开启某一取物舱门，系统同样强制要求输入密码进行验证，防止未授权的操作干扰

---

##### verifyPassword

**方法签名**：
```java
void verifyPassword(int doorId, String password, IResultCallback<Boolean> callback)
```

**功能说明**：验证舱门密码

**参数说明**：
- `doorId`: 舱门ID
- `password`: 密码
- `callback`: 结果回调，返回验证结果

**返回值**：无（通过回调返回）

**调用示例**：
```java
doorService.verifyPassword(1, "123456", new IResultCallback<Boolean>() {
    @Override
    public void onSuccess(Boolean result) {
        if (result) {
            Log.d(TAG, "Password verified");
        } else {
            Log.e(TAG, "Password incorrect");
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Verification failed: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 验证失败

**前置条件**：
- SDK已初始化
- 舱门ID有效

---

##### setFootSwitchEnabled

**方法签名**：
```java
void setFootSwitchEnabled(boolean enabled, IResultCallback<Void> callback)
```

**功能说明**：设置脚踩灯光快捷开关门功能

**参数说明**：
- `enabled`: true-启用，false-禁用
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
doorService.setFootSwitchEnabled(true, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Foot switch enabled");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to enable foot switch: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化

**注意事项**：
- 出发前脚踩灯光开关门：支持标准配送模式、循环配送模式使用

---

##### setAutoLeaveEnabled

**方法签名**：
```java
void setAutoLeaveEnabled(boolean enabled, IResultCallback<Void> callback)
```

**功能说明**：设置到达后脚踩灯光自动离开功能

**参数说明**：
- `enabled`: true-启用，false-禁用
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
doorService.setAutoLeaveEnabled(true, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Auto leave enabled");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to enable auto leave: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化

**注意事项**：
- 到达后脚踩灯光自动离开：支持目标点到达场景

---

##### getDoorStatus / getAllDoorsStatus

**方法签名**：
```java
void getDoorStatus(int doorId, IResultCallback<Boolean> callback)
void getAllDoorsStatus(IResultCallback<Boolean[]> callback)
```

**功能说明**：获取指定舱门状态/获取所有舱门状态

**参数说明**：
- `doorId`: 舱门ID
- `callback`: 结果回调，返回舱门状态（true-打开，false-关闭）

**返回值**：无（通过回调返回）

**调用示例**：
```java
doorService.getDoorStatus(1, new IResultCallback<Boolean>() {
    @Override
    public void onSuccess(Boolean isOpen) {
        if (isOpen) {
            Log.d(TAG, "Door 1 is open");
        } else {
            Log.d(TAG, "Door 1 is closed");
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get door status: " + error.getMessage());
    }
});

doorService.getAllDoorsStatus(new IResultCallback<Boolean[]>() {
    @Override
    public void onSuccess(Boolean[] statuses) {
        for (int i = 0; i < statuses.length; i++) {
            Log.d(TAG, "Door " + i + ": " + (statuses[i] ? "open" : "closed"));
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get all doors status: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 获取状态失败

**前置条件**：
- SDK已初始化

---

### 3.4 远程服务接口 - IRemoteService

#### 3.4.1 接口说明

提供远程呼叫功能，包括远程呼叫启用、呼叫循环、呼叫到达等。

#### 3.4.2 方法定义

##### enableRemoteCall / isRemoteCallEnabled

**方法签名**：
```java
void enableRemoteCall(boolean enabled, IResultCallback<Void> callback)
void isRemoteCallEnabled(IResultCallback<Boolean> callback)
```

**功能说明**：启用/禁用远程呼叫功能 / 检查远程呼叫是否启用

**参数说明**：
- `enabled`: true-启用，false-禁用
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
remoteService.enableRemoteCall(true, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Remote call enabled");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to enable remote call: " + error.getMessage());
    }
});

remoteService.isRemoteCallEnabled(new IResultCallback<Boolean>() {
    @Override
    public void onSuccess(Boolean enabled) {
        if (enabled) {
            Log.d(TAG, "Remote call is enabled");
        } else {
            Log.d(TAG, "Remote call is disabled");
        }
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to check remote call status: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_DEVICE`: 操作失败

**前置条件**：
- SDK已初始化

**注意事项**：
- 开启后，空闲状态下的机器人可以被【擎朗机器人app】【擎朗呼叫器】【API接口】远程呼叫到指定点位或回收（即呼叫回收）

---

##### callLoop

**方法签名**：
```java
void callLoop(PointInfo targetPoint, int duration, IResultCallback<String> callback)
```

**功能说明**：呼叫机器人到目标点进行循环

**参数说明**：
- `targetPoint`: 目标点位
- `duration`: 倒计时时长（秒）
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
remoteService.callLoop(targetPoint, 60, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Loop call started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to call loop: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 呼叫失败

**前置条件**：
- SDK已初始化
- 远程呼叫已启用
- 机器人处于空闲状态

**注意事项**：
- 呼叫机器到目标点进行循环，倒计时结束后前往返回点

---

##### callArrival

**方法签名**：
```java
void callArrival(PointInfo targetPoint, int duration, IResultCallback<String> callback)
```

**功能说明**：呼叫机器人到目标点

**参数说明**：
- `targetPoint`: 目标点位
- `duration`: 倒计时时长（秒）
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
remoteService.callArrival(targetPoint, 30, new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Arrival call started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to call arrival: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 参数无效
- `ErrorCode.ERROR_TASK_FAILED`: 呼叫失败

**前置条件**：
- SDK已初始化
- 远程呼叫已启用
- 机器人处于空闲状态

**注意事项**：
- 仅呼叫机器到目标点，倒计时结束后前往返回点

---

##### callRecovery

**方法签名**：
```java
void callRecovery(IResultCallback<String> callback)
```

**功能说明**：呼叫机器人回收

**参数说明**：
- `callback`: 结果回调，返回任务ID

**返回值**：无（通过回调返回）

**调用示例**：
```java
remoteService.callRecovery(new IResultCallback<String>() {
    @Override
    public void onSuccess(String taskId) {
        Log.d(TAG, "Recovery call started: " + taskId);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to call recovery: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_TASK_FAILED`: 呼叫失败

**前置条件**：
- SDK已初始化
- 远程呼叫已启用
- 机器人处于空闲状态

---

##### setStayDuration / getStayDuration

**方法签名**：
```java
void setStayDuration(int durationSeconds, IResultCallback<Void> callback)
void getStayDuration(IResultCallback<Integer> callback)
```

**功能说明**：设置/获取到达后停留时长

**参数说明**：
- `durationSeconds`: 停留时长（秒）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
remoteService.setStayDuration(60, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Stay duration set to 60s");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set stay duration: " + error.getMessage());
    }
});

remoteService.getStayDuration(new IResultCallback<Integer>() {
    @Override
    public void onSuccess(Integer duration) {
        Log.d(TAG, "Stay duration: " + duration + "s");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get stay duration: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 时长参数无效
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化

**注意事项**：
- 开启时可设置时长，关闭后则一直停留在目标点

---

### 3.5 音频服务接口 - IAudioService

#### 3.5.1 接口说明

提供音频控制功能，包括背景音乐、音量调节、语音播报频率等。

#### 3.5.2 方法定义

##### setDeliveryMusic / setLoopMusic

**方法签名**：
```java
void setDeliveryMusic(String musicPath, IResultCallback<Void> callback)
void setLoopMusic(String musicPath, IResultCallback<Void> callback)
```

**功能说明**：设置配送背景音乐 / 设置循环配送背景音乐

**参数说明**：
- `musicPath`: 音乐文件路径
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
audioService.setDeliveryMusic("/sdcard/music/delivery.mp3", new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Delivery music set");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set delivery music: " + error.getMessage());
    }
});

audioService.setLoopMusic("/sdcard/music/loop.mp3", new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Loop music set");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set loop music: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 音乐路径无效
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化
- 音乐文件存在

---

##### setVoiceVolume / getVoiceVolume

**方法签名**：
```java
void setVoiceVolume(int volume, IResultCallback<Void> callback)
void getVoiceVolume(IResultCallback<Integer> callback)
```

**功能说明**：设置/获取语音音量

**参数说明**：
- `volume`: 音量值（0-100）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
audioService.setVoiceVolume(80, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Voice volume set to 80");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set voice volume: " + error.getMessage());
    }
});

audioService.getVoiceVolume(new IResultCallback<Integer>() {
    @Override
    public void onSuccess(Integer volume) {
        Log.d(TAG, "Voice volume: " + volume);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get voice volume: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 音量值无效
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化
- 音量值在有效范围内（0-100）

---

##### setDeliveryVolume / getDeliveryVolume

**方法签名**：
```java
void setDeliveryVolume(int volume, IResultCallback<Void> callback)
void getDeliveryVolume(IResultCallback<Integer> callback)
```

**功能说明**：设置/获取配送音量

**参数说明**：
- `volume`: 音量值（0-100）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
audioService.setDeliveryVolume(70, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Delivery volume set to 70");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set delivery volume: " + error.getMessage());
    }
});

audioService.getDeliveryVolume(new IResultCallback<Integer>() {
    @Override
    public void onSuccess(Integer volume) {
        Log.d(TAG, "Delivery volume: " + volume);
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get delivery volume: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 音量值无效
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化
- 音量值在有效范围内（0-100）

**注意事项**：
- 支持分别调节"配送背景音乐"和"语音音量"

---

##### setAnnouncementFrequency

**方法签名**：
```java
void setAnnouncementFrequency(int frequency, IResultCallback<Void> callback)
```

**功能说明**：设置语音播报频率

**参数说明**：
- `frequency`: 播报频率（秒）
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
audioService.setAnnouncementFrequency(30, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Announcement frequency set to 30s");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to set announcement frequency: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 频率值无效
- `ErrorCode.ERROR_DEVICE`: 设置失败

**前置条件**：
- SDK已初始化
- 频率值有效

**注意事项**：
- 支持设置"配送背景音乐"和"取物语音播报频率"
- 支持设置"循环配送背景音乐"和"循环配送语音播报频率"

---

##### getAudioConfig / updateAudioConfig

**方法签名**：
```java
void getAudioConfig(IResultCallback<AudioConfig> callback)
void updateAudioConfig(AudioConfig config, IResultCallback<Void> callback)
```

**功能说明**：获取/更新音频配置

**参数说明**：
- `config`: 音频配置对象
- `callback`: 结果回调

**返回值**：无（通过回调返回）

**调用示例**：
```java
audioService.getAudioConfig(new IResultCallback<AudioConfig>() {
    @Override
    public void onSuccess(AudioConfig config) {
        Log.d(TAG, "Voice volume: " + config.getVoiceVolume());
        Log.d(TAG, "Delivery volume: " + config.getDeliveryVolume());
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to get audio config: " + error.getMessage());
    }
});

AudioConfig config = new AudioConfig();
config.setVoiceVolume(80);
config.setDeliveryVolume(70);
config.setAnnouncementFrequency(30);

audioService.updateAudioConfig(config, new IResultCallback<Void>() {
    @Override
    public void onSuccess(Void result) {
        Log.d(TAG, "Audio config updated");
    }

    @Override
    public void onError(ApiError error) {
        Log.e(TAG, "Failed to update audio config: " + error.getMessage());
    }
});
```

**异常处理**：
- `ErrorCode.ERROR_VALIDATION`: 配置参数无效
- `ErrorCode.ERROR_DEVICE`: 操作失败

**前置条件**：
- SDK已初始化

---

## 四、数据模型定义

### 4.1 DeviceInfo（设备信息）

```java
public class DeviceInfo {
    private int id;                          // 设备ID
    private String name;                     // 设备名称
    private int pid;                         // 进程ID
    private String device;                   // 设备类型
    private String sn;                       // 序列号
    private VersionInfo version;            // 版本信息
    private EnvInfo env;                     // 环境信息

    public static class VersionInfo {
        private SoftwareInfo sw;            // 软件版本
        private HardwareInfo hw;            // 硬件版本

        public static class SoftwareInfo {
            private String number;           // 版本号
            private String base;             // 基础版本
            private String md5;              // MD5校验值
        }

        public static class HardwareInfo {
            private String number;           // 硬件版本号
        }
    }

    public static class EnvInfo {
        private String number;              // 环境版本号
        private String base;                // 基础环境
        private String md5;                 // MD5校验值
    }
}
```

### 4.2 MotorInfo（电机信息）

```java
public class MotorInfo {
    private int code;                       // 状态码
    private String desc;                    // 描述
    private int position;                   // 位置
    private boolean enabled;                // 是否启用
    private int speed;                      // 速度
}
```

### 4.3 PointInfo（点位信息）

```java
public class PointInfo {
    private String id;                      // 点位ID
    private String name;                    // 点位名称
    private int floor;                      // 楼层
    private double x;                       // X坐标
    private double y;                       // Y坐标
    private String type;                    // 点位类型
    private long lastUsedTime;              // 最后使用时间

    public enum PointType {
        DESTINATION,                        // 目的地
        LOOP,                              // 循环点
        RETURN,                            // 返回点
        STANDBY,                           // 待机点
        RECOVERY                           // 回收点
    }
}
```

### 4.4 DeliveryTask（配送任务）

```java
public class DeliveryTask {
    private String taskId;                  // 任务ID
    private DeliveryType type;              // 配送类型
    private List<PointInfo> points;         // 点位列表
    private DeliveryConfig config;          // 配送配置
    private DeliveryStatus status;          // 任务状态
    private String currentPointId;          // 当前点位ID
    private int progress;                   // 进度（0-100）
    private long startTime;                // 开始时间
    private long endTime;                  // 结束时间

    public enum DeliveryType {
        STANDARD,                           // 标准配送
        LOOP,                              // 循环配送
        RECOVERY,                          // 回收配送
        SLOW                               // 慢速配送
    }

    public enum DeliveryStatus {
        PENDING,                            // 待执行
        RUNNING,                            // 执行中
        PAUSED,                             // 已暂停
        COMPLETED,                          // 已完成
        CANCELLED,                          // 已取消
        FAILED                             // 失败
    }
}
```

### 4.5 DeliveryConfig（配送配置）

```java
public class DeliveryConfig {
    private boolean showRecentPoints;       // 显示最近使用点位
    private DeliveryMode deliveryMode;      // 配送模式
    private int stayDuration;              // 目标点停留时长（秒）
    private int pauseDuration;             // 行走暂停时长（秒）
    private int deliverySpeed;             // 配送行走速度（cm/s）
    private int returnSpeed;               // 返航行走速度（cm/s）
    private boolean slowStart;              // 慢速出发
    private int loopCount;                  // 循环次数
    private int loopDuration;              // 循环时长（秒）

    public enum DeliveryMode {
        SINGLE_FLOOR_SINGLE_POINT,          // 单层单点
        SINGLE_FLOOR_MULTI_POINT,           // 单层多点
        MULTI_FLOOR,                       // 多楼层
        MULTI_POINT_NO_FLOOR               // 多点配送（无楼层）
    }
}
```

### 4.6 AudioConfig（音频配置）

```java
public class AudioConfig {
    private int voiceVolume;                // 语音音量（0-100）
    private int deliveryVolume;            // 配送音量（0-100）
    private String deliveryMusicPath;       // 配送背景音乐路径
    private String loopMusicPath;           // 循环配送背景音乐路径
    private int announcementFrequency;      // 语音播报频率（秒）
    private int loopAnnouncementFrequency;  // 循环配送语音播报频率（秒）
}
```

### 4.7 RobotState（机器人状态）

```java
public class RobotState {
    private int status;                     // 状态码
    private String message;                 // 状态消息
    private LocationInfo local;             // 本地位置信息
    private LocationInfo other;             // 其他位置信息
    private boolean isMoving;               // 是否移动中
    private int batteryLevel;               // 电池电量（0-100）
    private boolean isScramPressed;         // 急停按钮是否按下

    public static class LocationInfo {
        private int id;                     // 点位ID
        private double x;                   // X坐标
        private double y;                   // Y坐标
        private int status;                 // 状态
    }
}
```

## 五、回调与错误处理

### 5.1 回调接口

#### IResultCallback<T>

通用结果回调接口，用于处理异步操作的结果。

```java
public interface IResultCallback<T> {
    void onSuccess(T result);               // 成功回调
    void onError(ApiError error);           // 错误回调
}
```

#### IProgressCallback<T>

进度回调接口，用于处理带进度的异步操作。

```java
public interface IProgressCallback<T> extends IResultCallback<T> {
    void onProgress(int percent);           // 进度回调
    void onReadyToSend();                  // 准备发送回调
}
```

#### IStateCallback

状态变化回调接口，用于监听机器人状态变化。

```java
public interface IStateCallback {
    void onStateChanged(RobotState newState);              // 状态变化
    void onLocationChanged(double x, double y);           // 位置变化
    void onBatteryLevelChanged(int level);                // 电量变化
    void onScramButtonPressed(boolean pressed);          // 急停按钮状态
}
```

### 5.2 错误处理

#### ApiError

API错误类，包含错误码、错误消息、错误类型和原因。

```java
public class ApiError {
    private int code;                       // 错误码
    private String message;                 // 错误消息
    private ErrorType type;                 // 错误类型
    private Throwable cause;                // 异常原因

    public enum ErrorType {
        NETWORK_ERROR,                      // 网络错误
        DEVICE_ERROR,                       // 设备错误
        VALIDATION_ERROR,                   // 验证错误
        TIMEOUT_ERROR,                      // 超时错误
        UNKNOWN_ERROR                       // 未知错误
    }
}
```

#### ErrorCode

错误码常量定义。

```java
public class ErrorCode {
    public static final int SUCCESS = 0;                    // 成功
    public static final int ERROR_UNKNOWN = -1;            // 未知错误
    public static final int ERROR_NETWORK = -100;          // 网络错误
    public static final int ERROR_DEVICE = -200;           // 设备错误
    public static final int ERROR_TIMEOUT = -300;         // 超时错误
    public static final int ERROR_VALIDATION = -400;       // 验证错误
    public static final int ERROR_AUTHENTICATION = -500;   // 认证失败
    public static final int ERROR_PERMISSION_DENIED = -501;// 权限拒绝
    public static final int ERROR_TASK_NOT_FOUND = -600;   // 任务不存在
    public static final int ERROR_TASK_FAILED = -601;      // 任务失败
    public static final int ERROR_POINT_NOT_FOUND = -700;  // 点位不存在
    public static final int ERROR_DOOR_LOCKED = -800;      // 舱门锁定
    public static final int ERROR_PASSWORD_INCORRECT = -801;// 密码错误
    public static final int ERROR_SCRAM_PRESSED = -900;     // 急停按下
    public static final int ERROR_BATTERY_LOW = -901;      // 电量低
}
```

#### ErrorHandler

错误处理工具类。

```java
public class ErrorHandler {
    public static ApiError handleException(Exception e);                    // 处理异常
    public static ApiError createNetworkError(String message);             // 创建网络错误
    public static ApiError createDeviceError(String message);              // 创建设备错误
    public static ApiError createTimeoutError(String message);              // 创建超时错误
    public static ApiError createValidationError(String message);          // 创建验证错误
    public static void logError(ApiError error);                            // 记录错误
}
```

## 六、交互流程图

### 6.1 标准配送流程

```
用户选择点位
    ↓
创建配送任务
    ↓
调用 startStandardDelivery()
    ↓
验证任务参数
    ↓
发送配送指令到机器人
    ↓
机器人开始配送
    ↓
监听配送状态
    ↓
到达目标点
    ↓
用户验证密码打开舱门
    ↓
取物完成
    ↓
机器人返回待机点
    ↓
配送完成
```

### 6.2 循环配送流程

```
用户选择循环点位和循环次数
    ↓
创建循环配送任务
    ↓
调用 startLoopDelivery()
    ↓
验证任务参数
    ↓
发送循环配送指令到机器人
    ↓
机器人开始循环配送
    ↓
循环执行配送任务
    ↓
监听配送状态和进度
    ↓
达到循环次数或时长
    ↓
循环配送完成
    ↓
机器人返回待机点
```

### 6.3 远程呼叫流程

```
远程呼叫器/APP发送呼叫请求
    ↓
检查远程呼叫是否启用
    ↓
检查机器人是否空闲
    ↓
创建呼叫任务
    ↓
调用 callArrival() 或 callLoop()
    ↓
机器人前往目标点
    ↓
到达目标点
    ↓
等待停留时长
    ↓
倒计时结束
    ↓
机器人返回待机点
```

### 6.4 舱门控制流程

```
用户点击打开舱门
    ↓
检查舱门是否锁定
    ↓
如果锁定，要求输入密码
    ↓
验证密码
    ↓
密码验证通过
    ↓
调用 openDoor()
    ↓
打开舱门
    ↓
用户取物
    ↓
调用 closeDoor()
    ↓
关闭舱门
```

## 七、协作规范

### 7.1 接口变更管理

#### 7.1.1 版本号规则

采用语义化版本号：`MAJOR.MINOR.PATCH`

- **MAJOR（主版本号）**：不兼容的API修改
- **MINOR（次版本号）**：向下兼容的功能性新增
- **PATCH（修订号）**：向下兼容的问题修正

#### 7.1.2 变更日志

每次接口变更必须更新变更日志，包括：
- 变更日期
- 变更类型（新增/修改/删除）
- 变更内容
- 影响范围
- 兼容性说明

#### 7.1.3 兼容性说明

- 新增接口：不影响现有功能
- 修改接口：保持向后兼容，提供过渡期
- 删除接口：提前通知，提供替代方案

### 7.2 接口测试标准

#### 7.2.1 单元测试规范

- 每个接口方法必须有对应的单元测试
- 测试覆盖率不低于80%
- 测试用例包括正常场景、边界场景、异常场景

#### 7.2.2 集成测试规范

- 测试接口之间的协作
- 测试与SDK的集成
- 测试异常处理机制

#### 7.2.3 接口测试用例

每个接口必须包含以下测试用例：
- 正常调用测试
- 参数验证测试
- 错误处理测试
- 并发调用测试
- 性能测试

### 7.3 接口版本控制策略

#### 7.3.1 版本管理

- 使用Git进行版本控制
- 每个版本打Tag
- 保留历史版本

#### 7.3.2 平滑升级

- 提供版本迁移指南
- 提供兼容性适配层
- 逐步废弃旧接口

#### 7.3.3 向后兼容

- 新增接口不影响现有接口
- 修改接口保持方法签名不变
- 删除接口提供替代方案

## 八、附录

### 8.1 术语表

| 术语 | 说明 |
|------|------|
| SDK | Software Development Kit，软件开发工具包 |
| API | Application Programming Interface，应用程序编程接口 |
| 回调 | 异步操作完成后调用的函数 |
| 点位 | 机器人的物理位置 |
| 配送 | 机器人运送物品的过程 |
| 循环配送 | 机器人在多个点位间往复移动 |
| 回收配送 | 从多个点位收集物品并运回回收点 |
| 慢速配送 | 以低速平稳的方式运送精密或易碎物品 |
| 急停按钮 | 紧急停止机器人运动的按钮 |
| 舱门 | 机器人用于存放物品的舱室门 |
| 远程呼叫 | 通过远程方式呼叫机器人到指定点位 |

### 8.2 参考文档

- Peanut SDK V1.3.4开发文档
- 威高机器人控制系统功能需求书

### 8.3 联系方式

如有问题或建议，请联系：
- 技术支持：[待补充]
- 项目负责人：[待补充]
